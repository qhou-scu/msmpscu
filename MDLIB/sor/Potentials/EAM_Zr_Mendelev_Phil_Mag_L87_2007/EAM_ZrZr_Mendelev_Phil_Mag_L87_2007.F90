 module EAM_ZrZr_Mendelev_Phil_Mag_L87_2007
  !***  this module is to calculate the potential and force between Zr-Zr atoms
  !REFERENCE: Philosophical Magazine Letters    VOL.87,NO.5,May 2007 ,349-359

  !HISTORY:  Firstly edited by  Cui ZG  on 2011.12.28
  !          Rearranged by Hou Qing, Jan., 2015

 use MD_CONSTANTS
        implicit none
        private::H0, H
 contains

 subroutine NN_Interaction(rr,POTR, FPOTR)
  !***  PURPOSE: to calculate the potential and force by Born-Mayer model
  !     INPUT:   RR, the distance between two particle
  !     OUTPUT:  POTR, FPOTR

      implicit none
      real(KIND=8),intent(in)::rr
      real(KIND=8),intent(out)::POTR, FPOTR

      !*******************************************************************
      real(KIND=8)::r

      R = RR*1.D8

      POTR= (2.3039613229091D+04/r)*(0.1818*exp(-3.3035595072498D+01*r) + &
                                     0.5099*exp(-9.7279503865046D+00*r) + &
                                     0.2802*exp(-4.1593878920967D+00*r) + &
                                     0.02817*exp(-2.0812424895674D+00*r) )*H0(1.0000-r) + &

             exp(1.2333392307614D+01 - 1.0847321969086D+01*r + 4.5733524424508D+00*r**2 - 8.5266291445935D-01*r**3)*H(r-1.0000)*H0(2.3000-r) + &

            (-1.4261501929757D+01*(H(3.5-r)*(3.5-r)**4) + &
              1.5850036758176D+01*(H(3.5-r)*(3.5-r)**5) - &
              1.1325102264291D+01*(H(3.5-r)*(3.5-r)**6) - &
              4.0971114831366D+00*(H(3.5-r)*(3.5-r)**7) + &
              3.6739378016909D+00*(H(3.5-r)*(3.5-r)**8) + &

              1.3066813393823D+00*(H(6.0-r)*(6.0-r)**4) - &
              6.0542710718094D-01*(H(6.0-r)*(6.0-r)**5) + &
              1.0055527194350D+00*(H(6.0-r)*(6.0-r)**6) - &
              1.4918186777562D-01*(H(6.0-r)*(6.0-r)**7) + &
              3.2773112059590D-02*(H(6.0-r)*(6.0-r)**8) + &

              1.1433120304691D-02*(H(7.6-r)*(7.6-r)**4) - &
              2.1982172508973D-02*(H(7.6-r)*(7.6-r)**5) - &
              1.2542439692607D-02*(H(7.6-r)*(7.6-r)**6) + &
              2.5062673874258D-02*(H(7.6-r)*(7.6-r)**7) - &
              7.5442887837418D-03*(H(7.6-r)*(7.6-r)**8) )*H(r-2.3000)
      !POTR= (2.3039613229091D+04/r)*(0.1818*exp(-3.3035595072498D+01*r)+0.5099*exp(-9.7279503865046D+00*r)+&
       !       0.2802*exp(-4.1593878920967D+00*r)+0.02817*exp(-2.0812424895674D+00*r))*H0(1.0000-r)+&
      !exp(1.288223003819D+01-1.2183850157814D+01*r+5.5998956281737D+00*r**2-10.915156420318D-01*r**3)*H(r-1.0000)*H0(2.3000-r)+&
      !(0.84670497139946D+01*(H(3.5-r)*(3.5-r)**4)-4.6183472786003D+01*(H(3.5-r)*(3.5-r)**5)+7.9633499844770D+01*(H(3.5-r)*(3.5-r)**6)-&
      !64.847634731465D+00*(H(3.5-r)*(3.5-r)**7)+19.454623850774D+00*(H(3.5-r)*(3.5-r)**8)-0.097845860135187D+00*(H(6.0-r)*(6.0-r)**4)-&
      !4.7537134413743D-01*(H(6.0-r)*(6.0-r)**5)-0.00096806164225329D+00*(H(6.0-r)*(6.0-r)**6)-1.6355187497617D-01*(H(6.0-r)*(6.0-r)**7)-&
      !0.090914903435333D-02*(H(6.0-r)*(6.0-r)**8)-2.2038480751134D-02*(H(7.6-r)*(7.6-r)**4)-6.0955465943384D-02*(H(7.6-r)*(7.6-r)**5)+&
      !11.573689045653D-02*(H(7.6-r)*(7.6-r)**6)-6.2697675088029D-02*(H(7.6-r)*(7.6-r)**7)+&
      !11.273545085049D-03*(H(7.6-r)*(7.6-r)**8))*H(r-2.3000)


      FPOTR= (2.3039613229091D+04/r)*( (1/r+3.3035595072498D+01)*0.1818*exp(-3.3035595072498D+01*r) + &
                                       (1/r+9.7279503865046D+00)*0.5099*exp(-9.7279503865046D+00*r) + &
                                       (1/r+4.1593878920967D+00)*0.2802*exp(-4.1593878920967D+00*r) + &
                                       (1/r+2.0812424895674D+00)*0.02817*exp(-2.0812424895674D+00*r) )*H0(1.0000-r) - &

             (-1.0847321969086D+01 + 9.1467048849017D+00*r - 2.5579887433781D+00*r**2)* &
             exp(1.2333392307614D+01 - 1.0847321969086D+01*r + 4.5733524424508D+00*r**2 - 8.5266291445935D-01*r**3)*H(r-1.0000)*H0(2.3000-r)+&

            (-1.4261501929757D+01*(H(3.5-r)*4*(3.5-r)**3) + &
              1.5850036758176D+01*(H(3.5-r)*5*(3.5-r)**4) - &
              1.1325102264291D+01*(H(3.5-r)*6*(3.5-r)**5) - &
              4.0971114831366D+00*(H(3.5-r)*7*(3.5-r)**6) + &
              3.6739378016909D+00*(H(3.5-r)*8*(3.5-r)**7) + &

              1.3066813393823D+00*(H(6.0-r)*4*(6.0-r)**3) - &
              6.0542710718094D-01*(H(6.0-r)*5*(6.0-r)**4) + &
              1.0055527194350D+00*(H(6.0-r)*6*(6.0-r)**5) - &
              1.4918186777562D-01*(H(6.0-r)*7*(6.0-r)**6) + &
              3.2773112059590D-02*(H(6.0-r)*8*(6.0-r)**7) + &

              1.1433120304691D-02*(H(7.6-r)*4*(7.6-r)**3) - &
              2.1982172508973D-02*(H(7.6-r)*5*(7.6-r)**4) - &
              1.2542439692607D-02*(H(7.6-r)*6*(7.6-r)**5) + &
              2.5062673874258D-02*(H(7.6-r)*7*(7.6-r)**6) - &
              7.5442887837418D-03*(H(7.6-r)*8*(7.6-r)**7) )*H(r-2.3000)
   !FPOTR=(2.3039613229091D+04/r)*((1/r+3.3035595072498D+01)*0.1818*exp(-3.3035595072498D+01*r)+&
      !    (1/r+9.7279503865046D+00)*0.5099*exp(-9.7279503865046D+00*r)+(1/r+4.1593878920967D+00)*0.2802*exp(-4.1593878920967D+00*r)+&
       !         (1/r+2.0812424895674D+00)*0.02817*exp(-2.0812424895674D+00*r))*H0(1.0000-r)-&
        !             (-1.2183850157814D+01+2*5.5998956281737D+00*r-3*10.915156420318D-01*r**2)*&
         !    exp(1.2333392307614D+01-1.0847321969086D+01*r+4.5733524424508D+00*r**2-8.5266291445935D-01*r**3)*H(r-1.0000)*H0(2.3000-r)+&
          !     (0.84670497139946D+01*(H(3.5-r)*4*(3.5-r)**3)-4.6183472786003D+01*(H(3.5-r)*5*(3.5-r)**4)+7.9633499844770D+01*(H(3.5-r)*6*(3.5-r)**5)-&
  !64.847634731465D+00*(H(3.5-r)*7*(3.5-r)**6)+19.454623850774D+00*(H(3.5-r)*8*(3.5-r)**7)-0.097845860135187D+00*(H(6.0-r)*4*(6.0-r)**3)-&
  !    4.7537134413743D-01*(H(6.0-r)*5*(6.0-r)**4)-0.00096806164225329D+00*(H(6.0-r)*6*(6.0-r)**5)-1.6355187497617D-01*(H(6.0-r)*7*(6.0-r)**6)-&
  !    0.090914903435333D-02*(H(6.0-r)*8*(6.0-r)**7)-2.2038480751134D-02*(H(7.6-r)*4*(7.6-r)**3)-6.0955465943384D-02*(H(7.6-r)*5*(7.6-r)**4)+&
  !    11.573689045653D-02*(H(7.6-r)*6*(7.6-r)**5)-6.2697675088029D-02*(H(7.6-r)*7*(7.6-r)**6)+&
  !    11.273545085049D-03*(H(7.6-r)*8*(7.6-r)**7))*H(r-2.3000)

      POTR   = C_HALF*POTR*CP_EVERG
      FPOTR  = FPOTR*CP_EVERG/CP_A2CM

  return
end subroutine NN_Interaction
!*********************************************************************

!*********************************************************************
subroutine NE_Interaction(rr,POTB, FPOTB)
  !***  PURPOSE: to calculate the attractive potential by EAM
  !
  !     INPUT:   r, the distance between two particle
  !     OUTPUT: POTB,FPOTB
  implicit none
      real(KIND=8),intent(in)::rr
      real(KIND=8),intent(out)::POTB, FPOTB

      real(KIND=8)::r

      R = RR*1.D8

      POTB= 7.7718711248373D-01*(H(5.6-r)*(5.6-r)**4) - 4.8102928454986D-01*(H(5.6-r)*(5.6-r)**5) + &
            1.4501312593993D-01*(H(5.6-r)*(5.6-r)**6) - 2.1292226813959D-02*(H(5.6-r)*(5.6-r)**7) + &
            1.2209217625670D-03*(H(5.6-r)*(5.6-r)**8)

      FPOTB=7.7718711248373D-01*(H(5.6-r)*4*(5.6-r)**3) - 4.8102928454986D-01*(H(5.6-r)*5*(5.6-r)**4) + &
            1.4501312593993D-01*(H(5.6-r)*6*(5.6-r)**5) - 2.1292226813959D-02*(H(5.6-r)*7*(5.6-r)**6) + &
            1.2209217625670D-03*(H(5.6-r)*8*(5.6-r)**7)
      return
end subroutine NE_Interaction
!*********************************************************************

!*******************************************************************
subroutine EMBED_Func(rho,FRHO, DFRHO)
  !***  PURPOSE: to calculate the embedment function F(rho) and  dF(rho)/drho
  !
  !     INPUT:   rho, the electron density
  !     OUTPUT:  FRHO, DFRHO
  real(KINDDF),intent(in)::rho
  real(KINDDF),intent(out)::FRHO, DFRHO


       FRHO = 1.0000000000000D+00*(-rho**0.5) -             &
              1.9162462126235D-07*(H(rho-60)*(rho-60)**4) + &
              4.6418727035037D-07*(H(rho-70)*(rho-70)**4) + &
              6.6448294272955D-07*(H(rho-80)*(rho-80)**4) - &
              2.0680252960229D-06*(H(rho-85)*(rho-85)**4) + &
              1.1387131464983D-06*(H(rho-90)*(rho-90)**4 )

       DFRHO= 1.0000000000000D+00*(-0.5/rho**0.5) -          &
              (1.9162462126235D-07*(H(rho-60)*(rho-60)**3) + &
               4.6418727035037D-07*(H(rho-70)*(rho-70)**3) + &
               6.6448294272955D-07*(H(rho-80)*(rho-80)**3) - &
               2.0680252960229D-06*(H(rho-85)*(rho-85)**3) + &
               1.1387131464983D-06*(H(rho-90)*(rho-90)**3) )*4.D0


       FRHO = FRHO*CP_EVERG
       DFRHO = DFRHO*CP_EVERG
     return

end subroutine EMBED_Func
!*********************************************************************

!*********************************************************************
 FUNCTION   H(X)
 !Step function for X>=0
 implicit none
 REAL(KIND=8)::x
 REAL(KIND=8)::H
 if  (X.GE.0)  THEN
 H=1
 ELSE
 H=C_ZERO
 END IF

 END  FUNCTION H
!*********************************************************************

!*********************************************************************
  FUNCTION  H0(X)
 !Step function for X>0
  IMPLICIT NONE
  REAL(KIND=8)::X
  REAL(KIND=8)::H0

  IF(X.GT.0)  THEN
  H0=1
  ELSE
  H0=C_ZERO
  END IF

  END FUNCTION H0
!*********************************************************************
end module  EAM_ZrZr_Mendelev_Phil_Mag_L87_2007
