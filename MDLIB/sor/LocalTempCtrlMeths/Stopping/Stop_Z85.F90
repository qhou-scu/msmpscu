    module STOP_Z85_MODULE
  !***  this module is to calculate the stoping power of energitic atom in a media.
  !     this module is adapted from one of my old version code used in the bipartitional
  !     model for atom transport in materials.
  !
  !
  !     REFERNCE: Wolfgang Eckstein, Computer simulation of  Ion-Solid intercation, p70-71,
  !                                  Springer-Verlag, Berlin 1991
  !
  !     HISTORY:     adopted by Hou Qing, Feb., 2018
  !
  use MD_CONSTANTS
  implicit none
  !--- The data block for the stopping calculation of Zigler (1985)
  !     Pcoef
  !     NOTE: the shaoe of the array has been changed related to the old version
    real*8,dimension(92*8), private::m_PCOEF = (/      &
      0.9182700D-02, 0.5349600D-02, 0.6974100D+00, 0.4849300D+00, 0.3160700D+03, 0.1014300D+01, 0.9329300D+04, 0.5398900D-01, &
      0.1139300D+00, 0.5198400D-02, 0.1082200D+01, 0.3925200D+00, 0.1081000D+04, 0.1064500D+01, 0.4068500D+04, 0.1769900D-01, &
      0.8583700D+00, 0.5014700D-02, 0.1604400D+01, 0.3884400D+00, 0.1337300D+04, 0.1047000D+01, 0.2659200D+04, 0.1898000D-01, &
      0.8781000D+00, 0.5104900D-02, 0.5423200D+01, 0.2032000D+00, 0.1200600D+04, 0.1021100D+01, 0.1401800D+04, 0.3852900D-01, &
      0.1460800D+01, 0.4883600D-02, 0.2338000D+01, 0.4424900D+00, 0.1801300D+04, 0.1035200D+01, 0.1784100D+04, 0.2024000D-01, &
      0.3257900D+01, 0.4914800D-02, 0.2715600D+01, 0.3647300D+00, 0.2092200D+04, 0.1029100D+01, 0.2643600D+04, 0.1823700D-01, &
      0.5967400D+00, 0.5083700D-02, 0.4207300D+01, 0.3061200D+00, 0.2394200D+04, 0.1025500D+01, 0.4892100D+04, 0.1600600D-01, &
      0.7525300D+00, 0.5031400D-02, 0.4082400D+01, 0.3006700D+00, 0.2455800D+04, 0.1018100D+01, 0.5069700D+04, 0.1742600D-01, &
      0.1226000D+01, 0.5138500D-02, 0.3224600D+01, 0.3270300D+00, 0.2525000D+04, 0.1014200D+01, 0.7563600D+04, 0.1946900D-01, &
      0.1033200D+01, 0.5164500D-02, 0.3004000D+01, 0.3388900D+00, 0.2338600D+04, 0.9999700D+00, 0.6991200D+04, 0.2179900D-01, &
      0.6097200D+01, 0.4429200D-02, 0.3192900D+01, 0.4576300D+00, 0.1363300D+04, 0.9518200D+00, 0.2380600D+04, 0.8183500D-01, &
      0.1401300D+02, 0.4364600D-02, 0.2264100D+01, 0.3632600D+00, 0.2187400D+04, 0.9909800D+00, 0.6264800D+04, 0.4620000D-01, &
      0.3900100D-02, 0.4541500D-02, 0.5546300D+01, 0.3956200D+00, 0.1589200D+04, 0.9531600D+00, 0.8161600D+03, 0.4748400D-01, &
      0.2072000D+01, 0.4451600D-02, 0.3558500D+01, 0.5393300D+00, 0.1515200D+04, 0.9316100D+00, 0.1790300D+04, 0.3519800D-01, &
      0.1757500D+02, 0.3834600D-02, 0.7869400D-01, 0.1238800D+01, 0.2806000D+04, 0.9728400D+00, 0.1037600D+04, 0.1287900D-01, &
      0.1612600D+02, 0.3831500D-02, 0.5416400D-01, 0.1310400D+01, 0.2813300D+04, 0.9658700D+00, 0.1251400D+04, 0.1184700D-01, &
      0.3217000D+01, 0.4457900D-02, 0.3669600D+01, 0.5091000D+00, 0.2734600D+04, 0.9625300D+00, 0.2187500D+04, 0.1690700D-01, &
      0.2037900D+01, 0.4477500D-02, 0.3074300D+01, 0.5477300D+00, 0.3505000D+04, 0.9757500D+00, 0.1714000D+04, 0.1170100D-01, &
      0.7417100D+00, 0.4305100D-02, 0.1151500D+01, 0.9508300D+00, 0.9172100D+03, 0.8782000D+00, 0.3899300D+03, 0.1892600D+00, &
      0.9131600D+01, 0.4380900D-02, 0.5461100D+01, 0.3132700D+00, 0.3891800D+04, 0.9793300D+00, 0.6267900D+04, 0.1519600D-01, &
      0.7224700D+01, 0.4371800D-02, 0.6101700D+01, 0.3751100D+00, 0.2829200D+04, 0.9521800D+00, 0.6376100D+04, 0.2039800D-01, &
      0.1470000D+00, 0.4845600D-02, 0.6348500D+01, 0.4105700D+00, 0.2164100D+04, 0.9402800D+00, 0.5292600D+04, 0.5026300D-01, &
      0.5061100D+01, 0.3986700D-02, 0.2617400D+01, 0.5795700D+00, 0.2218900D+04, 0.9236100D+00, 0.6323000D+04, 0.2566900D-01, &
      0.5326700D+00, 0.4296800D-02, 0.3900500D+00, 0.1272500D+01, 0.1872700D+04, 0.9077600D+00, 0.6416600D+02, 0.3010700D-01, &
      0.4769700D+00, 0.4303800D-02, 0.3145200D+00, 0.1328900D+01, 0.1920500D+04, 0.9064900D+00, 0.4557600D+02, 0.2746900D-01, &
      0.2742600D-01, 0.3544300D-02, 0.3156300D-01, 0.2175500D+01, 0.1919500D+04, 0.9009900D+00, 0.2390200D+02, 0.2536300D-01, &
      0.1638300D+00, 0.4304200D-02, 0.7345400D-01, 0.1859200D+01, 0.1918400D+04, 0.8967800D+00, 0.2761000D+02, 0.2318400D-01, &
      0.4256200D+01, 0.4373700D-02, 0.1560600D+01, 0.7206700D+00, 0.1546800D+04, 0.8795800D+00, 0.3020200D+03, 0.4094400D-01, &
      0.2350800D+01, 0.4323700D-02, 0.2882000D+01, 0.5011300D+00, 0.1837700D+04, 0.8999200D+00, 0.2377000D+04, 0.4965000D-01, &
      0.3109500D+01, 0.3845500D-02, 0.1147700D+00, 0.1503700D+01, 0.2184700D+04, 0.8930900D+00, 0.6730600D+02, 0.1658800D-01, &
      0.1532200D+02, 0.4030600D-02, 0.6539100D+00, 0.6766800D+00, 0.3001700D+04, 0.9248400D+00, 0.3344200D+04, 0.1636600D-01, &
      0.3693200D+01, 0.4481300D-02, 0.8608000D+01, 0.2763800D+00, 0.2982700D+04, 0.9276000D+00, 0.3166600D+04, 0.3087400D-01, &
      0.7137300D+01, 0.4313400D-02, 0.9424700D+01, 0.2793700D+00, 0.2725800D+04, 0.9159700D+00, 0.3166100D+04, 0.2500800D-01, &
      0.4897900D+01, 0.4293700D-02, 0.3779300D+01, 0.5000400D+00, 0.2824500D+04, 0.9102800D+00, 0.1282400D+04, 0.1706100D-01, &
      0.1368300D+01, 0.4302400D-02, 0.2567900D+01, 0.6082200D+00, 0.6907800D+04, 0.9817000D+00, 0.6280100D+03, 0.6805500D-02, &
      0.1830100D+01, 0.4298300D-02, 0.2905700D+01, 0.6038000D+00, 0.4744600D+04, 0.9472200D+00, 0.9366400D+03, 0.9224200D-02, &
      0.4205600D+00, 0.4116900D-02, 0.1695000D-01, 0.2361600D+01, 0.2252700D+04, 0.8919200D+00, 0.3975200D+02, 0.2775700D-01, &
      0.3078000D+02, 0.3773600D-02, 0.5581300D+00, 0.7681600D+00, 0.7113200D+04, 0.9769700D+00, 0.1604400D+04, 0.6526800D-02, &
      0.1157600D+02, 0.4211900D-02, 0.7024400D+01, 0.3776400D+00, 0.4713500D+04, 0.9426400D+00, 0.2493200D+04, 0.1127000D-01, &
      0.6240600D+01, 0.4191600D-02, 0.5270100D+01, 0.4945300D+00, 0.4234600D+04, 0.9323200D+00, 0.2063900D+04, 0.1184400D-01, &
      0.3307300D+00, 0.4124300D-02, 0.1724600D+01, 0.1106200D+01, 0.1930200D+04, 0.8690700D+00, 0.2741600D+02, 0.3820800D-01, &
      0.1774700D-01, 0.4171500D-02, 0.1458600D+00, 0.1730500D+01, 0.1803600D+04, 0.8631500D+00, 0.2966900D+02, 0.3212300D-01, &
      0.3722900D+01, 0.4176800D-02, 0.4628600D+01, 0.5676900D+00, 0.1678000D+04, 0.8620200D+00, 0.3094000D+04, 0.6244000D-01, &
      0.1399800D+00, 0.4132900D-02, 0.2557300D+00, 0.1424100D+01, 0.1919300D+04, 0.8632600D+00, 0.7279700D+02, 0.3223500D-01, &
      0.2859000D+00, 0.4138600D-02, 0.3130100D+00, 0.1342400D+01, 0.1954800D+04, 0.8617500D+00, 0.1151800D+03, 0.2934200D-01, &
      0.7600200D+00, 0.4217900D-02, 0.3386000D+01, 0.7628500D+00, 0.1867400D+04, 0.8580500D+00, 0.6999400D+02, 0.3644800D-01, &
      0.6395700D+01, 0.4193500D-02, 0.5468900D+01, 0.4137800D+00, 0.1712600D+04, 0.8539700D+00, 0.1849300D+05, 0.5647100D-01, &
      0.3471700D+01, 0.4134400D-02, 0.3233700D+01, 0.6378800D+00, 0.1116400D+04, 0.8195900D+00, 0.4766000D+04, 0.1179000D+00, &
      0.2526500D+01, 0.4228200D-02, 0.4532000D+01, 0.5356200D+00, 0.1030800D+04, 0.8165200D+00, 0.1625200D+05, 0.1972200D+00, &
      0.7368300D+01, 0.4100700D-02, 0.4679100D+01, 0.5142800D+00, 0.1160000D+04, 0.8245400D+00, 0.1796500D+05, 0.1331600D+00, &
      0.7719700D+01, 0.4388000D-02, 0.3242000D+01, 0.6843400D+00, 0.1428100D+04, 0.8339800D+00, 0.1786700D+04, 0.6651200D-01, &
      0.1678000D+02, 0.4191800D-02, 0.9319800D+01, 0.2956800D+00, 0.3370900D+04, 0.9028900D+00, 0.7431700D+04, 0.2616000D-01, &
      0.4213200D+01, 0.4209800D-02, 0.4675300D+01, 0.5794500D+00, 0.3503900D+04, 0.8926100D+00, 0.1468900D+04, 0.1435900D-01, &
      0.4081800D+01, 0.4214000D-02, 0.4442500D+01, 0.5839300D+00, 0.3945300D+04, 0.9028100D+00, 0.1340500D+04, 0.1341400D-01, &
      0.1851700D+00, 0.3621500D-02, 0.5879000D-03, 0.3531500D+01, 0.2931300D+04, 0.8893600D+00, 0.2618000D+02, 0.2639300D-01, &
      0.4824800D+01, 0.4145800D-02, 0.6093400D+01, 0.5702600D+00, 0.2300100D+04, 0.8635900D+00, 0.2980700D+04, 0.3867900D-01, &
      0.4985700D+00, 0.4105400D-02, 0.1977500D+01, 0.9587700D+00, 0.7865500D+03, 0.7850900D+00, 0.8066000D+03, 0.4088200D+00, &
      0.3275400D+01, 0.4217700D-02, 0.5768000D+01, 0.5405400D+00, 0.6631300D+04, 0.9428200D+00, 0.7440700D+03, 0.8302600D-02, &
      0.2997800D+01, 0.4090100D-02, 0.4529900D+01, 0.6202500D+00, 0.2161200D+04, 0.8566900D+00, 0.1268600D+04, 0.4303100D-02, &
      0.2870100D+01, 0.4096000D-02, 0.4256800D+01, 0.6138000D+00, 0.2130400D+04, 0.8523500D+00, 0.1704100D+04, 0.3938500D-02, &
      0.1085300D+02, 0.4114900D-02, 0.5890700D+01, 0.4683400D+00, 0.2857200D+04, 0.8755000D+00, 0.3654200D+04, 0.2995500D-01, &
      0.3640700D+01, 0.4178200D-02, 0.4874200D+01, 0.5786100D+00, 0.1267700D+04, 0.8221100D+00, 0.3508200D+04, 0.2417400D+00, &
      0.1764500D+02, 0.4099200D-02, 0.6585500D+01, 0.3273400D+00, 0.3931300D+04, 0.9075400D+00, 0.5156700D+04, 0.3627800D-01, &
      0.7530900D+01, 0.4081400D-02, 0.4938900D+01, 0.5067900D+00, 0.2519700D+04, 0.8581900D+00, 0.3314600D+04, 0.3051400D-01, &
      0.5474200D+01, 0.4082900D-02, 0.4897000D+01, 0.5111300D+00, 0.2340100D+04, 0.8529600D+00, 0.2342700D+04, 0.3566200D-01, &
      0.4266100D+01, 0.4066700D-02, 0.4503200D+01, 0.5525700D+00, 0.2076400D+04, 0.8415100D+00, 0.1666600D+04, 0.4080100D-01, &
      0.6831300D+01, 0.4048600D-02, 0.4398700D+01, 0.5167500D+00, 0.2003000D+04, 0.8343700D+00, 0.1410400D+04, 0.3478000D-01, &
      0.1270700D+01, 0.4055300D-02, 0.4629500D+01, 0.5742800D+00, 0.1626300D+04, 0.8185800D+00, 0.9956800D+03, 0.5531900D-01, &
      0.5756100D+01, 0.4049100D-02, 0.4357000D+01, 0.5249600D+00, 0.2207300D+04, 0.8379600D+00, 0.1579500D+04, 0.2716500D-01, &
      0.1412700D+02, 0.4059600D-02, 0.5830400D+01, 0.3775500D+00, 0.3645900D+04, 0.8782300D+00, 0.3411800D+04, 0.1639200D-01, &
      0.6694800D+01, 0.4060300D-02, 0.4936100D+01, 0.4796100D+00, 0.2719000D+04, 0.8524900D+00, 0.1885800D+04, 0.1971300D-01, &
      0.3061900D+01, 0.4051100D-02, 0.3580300D+01, 0.5908200D+00, 0.2346100D+04, 0.8371300D+00, 0.1222000D+04, 0.2007200D-01, &
      0.1081100D+02, 0.3300800D-02, 0.1376700D+01, 0.7651200D+00, 0.2003700D+04, 0.8226900D+00, 0.1110600D+04, 0.2495800D-01, &
      0.2710100D+01, 0.4096100D-02, 0.1228900D+01, 0.9859800D+00, 0.1232400D+04, 0.7906600D+00, 0.1554200D+03, 0.4729400D-01, &
      0.5234500D+00, 0.4024400D-02, 0.1403800D+01, 0.8551000D+00, 0.1461400D+04, 0.7967700D+00, 0.5033400D+03, 0.3678900D-01, &
      0.4616000D+00, 0.4020300D-02, 0.1301400D+01, 0.8704300D+00, 0.1473500D+04, 0.7968700D+00, 0.4430900D+03, 0.3630100D-01, &
      0.9781400D+00, 0.4037400D-02, 0.2012700D+01, 0.7225000D+00, 0.1890800D+04, 0.8174700D+00, 0.9307000D+03, 0.2769000D-01, &
      0.3208600D+01, 0.4051000D-02, 0.3665800D+01, 0.5361800D+00, 0.3091200D+04, 0.8560200D+00, 0.1508100D+04, 0.1540100D-01, &
      0.2003500D+01, 0.4043100D-02, 0.7488200D+01, 0.3561000D+00, 0.4464300D+04, 0.8883600D+00, 0.3966500D+04, 0.1283900D-01, &
      0.1543000D+02, 0.3943200D-02, 0.1123700D+01, 0.7070300D+00, 0.4595700D+04, 0.8843700D+00, 0.1576500D+04, 0.8853400D-02, &
      0.3151200D+01, 0.4052400D-02, 0.4099600D+01, 0.5425000D+00, 0.3246300D+04, 0.8577200D+00, 0.1691800D+04, 0.1505800D-01, &
      0.7189600D+01, 0.4058800D-02, 0.8692700D+01, 0.3584200D+00, 0.4760600D+04, 0.8883300D+00, 0.2888300D+04, 0.1102900D-01, &
      0.9320900D+01, 0.4054000D-02, 0.1154300D+02, 0.3202700D+00, 0.4866200D+04, 0.8912400D+00, 0.3213400D+04, 0.1193500D-01, &
      0.2924200D+02, 0.3619500D-02, 0.1686400D+00, 0.1122600D+01, 0.5688000D+04, 0.8981200D+00, 0.1033300D+04, 0.7130300D-02, &
      0.1852200D+01, 0.3997300D-02, 0.3155600D+01, 0.6509600D+00, 0.3755000D+04, 0.8638300D+00, 0.1602000D+04, 0.1204200D-01, &
      0.3222000D+01, 0.4004100D-02, 0.5902400D+01, 0.5267800D+00, 0.4040200D+04, 0.8680400D+00, 0.1658400D+04, 0.1174700D-01, &
      0.9341200D+01, 0.3966100D-02, 0.7921000D+01, 0.4297700D+00, 0.5180900D+04, 0.8877300D+00, 0.2173200D+04, 0.9200700D-02, &
      0.3618300D+02, 0.3600300D-02, 0.5834100D+00, 0.8674700D+00, 0.6990200D+04, 0.9108200D+00, 0.1417100D+04, 0.6218700D-02, &
      0.5928400D+01, 0.3969500D-02, 0.6408200D+01, 0.5212200D+00, 0.4619500D+04, 0.8808300D+00, 0.2323500D+04, 0.1162700D-01, &
      0.5245400D+01, 0.3974400D-02, 0.6796900D+01, 0.4854200D+00, 0.4586300D+04, 0.8779400D+00, 0.2481500D+04, 0.1128200D-01, &
      0.3370200D+02, 0.3690100D-02, 0.4725700D+00, 0.8923500D+00, 0.5295700D+04, 0.8893000D+00, 0.2053300D+04, 0.9190800D-02, &
      0.2758900D+01, 0.3980600D-02, 0.3209200D+01, 0.6612200D+00, 0.2505400D+04, 0.8286300D+00, 0.2065100D+04, 0.2281600D-01/)

!... The data block for the stopping calculation of Zigler (1985)
!     Tgcoef
       real(KINDDF),dimension(92*7),private::m_TGCOEF=(/&
      0.1000000D+01, 0.1007800D+01, 0.1008000D+01, 0.7148600D-01, 0.4271000D+01, 0.1030900D+01, 0.1000000D+01, &
      0.4000000D+01, 0.4002600D+01, 0.4002600D+01, 0.1258800D+00, 0.1894000D+01, 0.1597600D+00, 0.1000000D+01, &
      0.7000000D+01, 0.7016000D+01, 0.6939000D+01, 0.5296900D+00, 0.4597000D+01, 0.5978200D+00, 0.1100000D+01, &
      0.9000000D+01, 0.9012000D+01, 0.9012200D+01, 0.1802400D+01, 0.1204600D+02, 0.1078100D+01, 0.1060000D+01, &
      0.1100000D+02, 0.1100900D+02, 0.1081100D+02, 0.2350200D+01, 0.1309300D+02, 0.1048600D+01, 0.1010000D+01, &
      0.1200000D+02, 0.1200000D+02, 0.1201100D+02, 0.2266200D+01, 0.1136400D+02, 0.1000000D+01, 0.1030000D+01, &
      0.1400000D+02, 0.1400300D+02, 0.1400700D+02, 0.8096300D+00, 0.3481000D+01, 0.1058000D+01, 0.1040000D+01, &
      0.1600000D+02, 0.1599500D+02, 0.1599900D+02, 0.1142900D+01, 0.4302000D+01, 0.9394200D+00, 0.9900000D+00, &
      0.1900000D+02, 0.1899800D+02, 0.1899800D+02, 0.1111100D+01, 0.3522000D+01, 0.7456200D+00, 0.9500000D+00, &
      0.2000000D+02, 0.1999200D+02, 0.2018300D+02, 0.1201500D+01, 0.3585000D+01, 0.3424000D+00, 0.9000000D+00, &
      0.2300000D+02, 0.2299000D+02, 0.2298900D+02, 0.9700000D+00, 0.2541000D+01, 0.4525900D+00, 0.8200000D+00, &
      0.2400000D+02, 0.2398500D+02, 0.2431200D+02, 0.1736600D+01, 0.4302000D+01, 0.7107400D+00, 0.8100000D+00, &
      0.2700000D+02, 0.2698200D+02, 0.2698100D+02, 0.2698100D+01, 0.6023000D+01, 0.9051900D+00, 0.8300000D+00, &
      0.2800000D+02, 0.2797700D+02, 0.2808600D+02, 0.2321200D+01, 0.4977000D+01, 0.9741100D+00, 0.8800000D+00, &
      0.3100000D+02, 0.3099400D+02, 0.3097300D+02, 0.1821900D+01, 0.3542000D+01, 0.9718400D+00, 0.1000000D+01, &
      0.3200000D+02, 0.3197000D+02, 0.3206400D+02, 0.2068600D+01, 0.3885000D+01, 0.8985200D+00, 0.9500000D+00, &
      0.3500000D+02, 0.3496900D+02, 0.3545300D+02, 0.1895600D+01, 0.3220000D+01, 0.7082700D+00, 0.9700000D+00, &
      0.4000000D+02, 0.3998000D+02, 0.3994800D+02, 0.1650400D+01, 0.2488000D+01, 0.3981600D+00, 0.9900000D+00, &
      0.3900000D+02, 0.3896000D+02, 0.3910200D+02, 0.8631800D+00, 0.1329000D+01, 0.3655200D+00, 0.9800000D+00, &
      0.4000000D+02, 0.3996000D+02, 0.4008000D+02, 0.1540000D+01, 0.2014000D+01, 0.6271200D+00, 0.9700000D+00, &
      0.4500000D+02, 0.4495600D+02, 0.4495600D+02, 0.2997100D+01, 0.4015000D+01, 0.8170700D+00, 0.9800000D+00, &
      0.4800000D+02, 0.4795000D+02, 0.4790000D+02, 0.4518900D+01, 0.5682000D+01, 0.9943000D+00, 0.9700000D+00, &
      0.5100000D+02, 0.5094000D+02, 0.5094200D+02, 0.6100800D+01, 0.7213000D+01, 0.1142300D+01, 0.9600000D+00, &
      0.5200000D+02, 0.5194000D+02, 0.5199600D+02, 0.7191700D+01, 0.8330000D+01, 0.1238100D+01, 0.9300000D+00, &
      0.5500000D+02, 0.5494000D+02, 0.5493800D+02, 0.7434100D+01, 0.8150000D+01, 0.1122200D+01, 0.9100000D+00, &
      0.5600000D+02, 0.5594000D+02, 0.5584700D+02, 0.7865800D+01, 0.8483000D+01, 0.9270500D+00, 0.9000000D+00, &
      0.5900000D+02, 0.5893000D+02, 0.5893300D+02, 0.8796000D+01, 0.8989000D+01, 0.1004700D+01, 0.8800000D+00, &
      0.5800000D+02, 0.5794000D+02, 0.5871000D+02, 0.8895500D+01, 0.9125000D+01, 0.1200000D+01, 0.9000000D+00, &
      0.6300000D+02, 0.6293000D+02, 0.6354000D+02, 0.8949300D+01, 0.8483000D+01, 0.1066100D+01, 0.9000000D+00, &
      0.6400000D+02, 0.6393000D+02, 0.6537000D+02, 0.7105400D+01, 0.6546000D+01, 0.9741100D+00, 0.9000000D+00, &
      0.6900000D+02, 0.6893000D+02, 0.6972000D+02, 0.5908500D+01, 0.5104000D+01, 0.8491200D+00, 0.9000000D+00, &
      0.7400000D+02, 0.7392000D+02, 0.7259000D+02, 0.5337500D+01, 0.4428000D+01, 0.9500000D+00, 0.8500000D+00, &
      0.7500000D+02, 0.7492000D+02, 0.7492200D+02, 0.5719200D+01, 0.4597000D+01, 0.1090300D+01, 0.9000000D+00, &
      0.8000000D+02, 0.7992000D+02, 0.7896000D+02, 0.4785500D+01, 0.3650000D+01, 0.1042900D+01, 0.9000000D+00, &
      0.7900000D+02, 0.7892000D+02, 0.7990900D+02, 0.3399500D+01, 0.2562000D+01, 0.4971500D+00, 0.9100000D+00, &
      0.8400000D+02, 0.8392000D+02, 0.8380000D+02, 0.2602100D+01, 0.1870000D+01, 0.3775500D+00, 0.9200000D+00, &
      0.8500000D+02, 0.8491000D+02, 0.8547000D+02, 0.1529000D+01, 0.1077000D+01, 0.3521100D+00, 0.9000000D+00, &
      0.8800000D+02, 0.8791000D+02, 0.8762000D+02, 0.2600000D+01, 0.1787000D+01, 0.5780100D+00, 0.9000000D+00, &
      0.9000000D+02, 0.8991000D+02, 0.8890500D+02, 0.4490200D+01, 0.3041000D+01, 0.7777300D+00, 0.9000000D+00, &
      0.9000000D+02, 0.8990000D+02, 0.9122000D+02, 0.6469500D+01, 0.4271000D+01, 0.1020700D+01, 0.9000000D+00, &
      0.9300000D+02, 0.9291000D+02, 0.9290600D+02, 0.8602400D+01, 0.5576000D+01, 0.1029000D+01, 0.9000000D+00, &
      0.9600000D+02, 0.9550000D+02, 0.9594000D+02, 0.1020600D+02, 0.6407000D+01, 0.1254200D+01, 0.8800000D+00, &
      0.0000000D+00, 0.0000000D+00, 0.9900000D+02, 0.0000000D+00, 0.0000000D+00, 0.1122000D+01, 0.9000000D+00, &
      0.1020000D+03, 0.1019000D+03, 0.1010700D+03, 0.1217700D+02, 0.7256000D+01, 0.1124100D+01, 0.8800000D+00, &
      0.1030000D+03, 0.1029000D+03, 0.1029100D+03, 0.1239900D+02, 0.7256000D+01, 0.1088200D+01, 0.8800000D+00, &
      0.1060000D+03, 0.1059000D+03, 0.1064000D+03, 0.1195500D+02, 0.6767000D+01, 0.1270900D+01, 0.9000000D+00, &
      0.1070000D+03, 0.1069000D+03, 0.1078700D+03, 0.1047300D+02, 0.5847000D+01, 0.1254200D+01, 0.9000000D+00, &
      0.1140000D+03, 0.1139000D+03, 0.1124000D+03, 0.8580200D+01, 0.4597000D+01, 0.9009400D+00, 0.8800000D+00, &
      0.1150000D+03, 0.1149000D+03, 0.1148200D+03, 0.7313400D+01, 0.3836000D+01, 0.7409300D+00, 0.9000000D+00, &
      0.1200000D+03, 0.1199000D+03, 0.1186900D+03, 0.7281600D+01, 0.3695000D+01, 0.8605400D+00, 0.9000000D+00, &
      0.1210000D+03, 0.1209000D+03, 0.1217500D+03, 0.6616800D+01, 0.3273000D+01, 0.9315500D+00, 0.9000000D+00, &
      0.1300000D+03, 0.1300000D+03, 0.1276000D+03, 0.6224400D+01, 0.2938000D+01, 0.1004700D+01, 0.9000000D+00, &
      0.1270000D+03, 0.1269000D+03, 0.1269000D+03, 0.4937300D+01, 0.2343000D+01, 0.5537900D+00, 0.9600000D+00, &
      0.1300000D+03, 0.1295000D+03, 0.1313000D+03, 0.3058900D+01, 0.1403000D+01, 0.4328900D+00, 0.1200000D+01, &
      0.1340000D+03, 0.1340000D+03, 0.1329100D+03, 0.1898600D+01, 0.8600000D+00, 0.3263600D+00, 0.9000000D+00, &
      0.1380000D+03, 0.1380000D+03, 0.1373400D+03, 0.3521500D+01, 0.1544000D+01, 0.5131000D+00, 0.8800000D+00, &
      0.1390000D+03, 0.1390000D+03, 0.1389100D+03, 0.6173800D+01, 0.2676000D+01, 0.6950000D+00, 0.8800000D+00, &
      0.1400000D+03, 0.1400000D+03, 0.1401200D+03, 0.6672400D+01, 0.2868000D+01, 0.7259100D+00, 0.8500000D+00, &
      0.1410000D+03, 0.1410000D+03, 0.1409100D+03, 0.6774400D+01, 0.2895000D+01, 0.7120200D+00, 0.9000000D+00, &
      0.1420000D+03, 0.1420000D+03, 0.1442400D+03, 0.7001900D+01, 0.2923000D+01, 0.6741300D+00, 0.9000000D+00, &
      0.0000000D+00, 0.0000000D+00, 0.1470000D+03, 0.0000000D+00, 0.0000000D+00, 0.7141800D+00, 0.9200000D+00, &
      0.1520000D+03, 0.1520000D+03, 0.1503500D+03, 0.7555300D+01, 0.3026000D+01, 0.7145300D+00, 0.9500000D+00, &
      0.1530000D+03, 0.1530000D+03, 0.1519600D+03, 0.5258100D+01, 0.2084000D+01, 0.5911000D+00, 0.9900000D+00, &
      0.1580000D+03, 0.1579000D+03, 0.1572500D+03, 0.7902000D+01, 0.3026000D+01, 0.7026300D+00, 0.1030000D+01, &
      0.1600000D+03, 0.1599000D+03, 0.1589200D+03, 0.8277300D+01, 0.3136000D+01, 0.6804900D+00, 0.1050000D+01, &
      0.1640000D+03, 0.1640000D+03, 0.1625000D+03, 0.8552600D+01, 0.3170000D+01, 0.6820300D+00, 0.1070000D+01, &
      0.1650000D+03, 0.1650000D+03, 0.1649300D+03, 0.8819800D+01, 0.3220000D+01, 0.6812100D+00, 0.1080000D+01, &
      0.1660000D+03, 0.1660000D+03, 0.1672600D+03, 0.9090200D+01, 0.3273000D+01, 0.6853200D+00, 0.1100000D+01, &
      0.1690000D+03, 0.1690000D+03, 0.1689300D+03, 0.9333100D+01, 0.3327000D+01, 0.6871500D+00, 0.1080000D+01, &
      0.1740000D+03, 0.1740000D+03, 0.1730400D+03, 0.6977400D+01, 0.2428000D+01, 0.6188400D+00, 0.1080000D+01, &
      0.1750000D+03, 0.1750000D+03, 0.1749700D+03, 0.9829800D+01, 0.3383000D+01, 0.7180100D+00, 0.1080000D+01, &
      0.1800000D+03, 0.1800000D+03, 0.1784900D+03, 0.1312400D+02, 0.4428000D+01, 0.8304800D+00, 0.1080000D+01, &
      0.1810000D+03, 0.1810000D+03, 0.1809500D+03, 0.1660100D+02, 0.5525000D+01, 0.1122200D+01, 0.1090000D+01, &
      0.1840000D+03, 0.1840000D+03, 0.1838500D+03, 0.1929200D+02, 0.6320000D+01, 0.1238100D+01, 0.1090000D+01, &
      0.1870000D+03, 0.1870000D+03, 0.1862000D+03, 0.2104000D+02, 0.6805000D+01, 0.1045000D+01, 0.1100000D+01, &
      0.1920000D+03, 0.1920000D+03, 0.1902000D+03, 0.2256200D+02, 0.7144000D+01, 0.1073300D+01, 0.1110000D+01, &
      0.1930000D+03, 0.1930000D+03, 0.1922000D+03, 0.2250600D+02, 0.7052000D+01, 0.1095300D+01, 0.1120000D+01, &
      0.1950000D+03, 0.1950000D+03, 0.1950900D+03, 0.2143800D+02, 0.6618000D+01, 0.1238100D+01, 0.1130000D+01, &
      0.1970000D+03, 0.1970000D+03, 0.1969700D+03, 0.1931100D+02, 0.5904000D+01, 0.1287900D+01, 0.1140000D+01, &
      0.2020000D+03, 0.2020000D+03, 0.2005900D+03, 0.1355300D+02, 0.4069000D+01, 0.7865400D+00, 0.1150000D+01, &
      0.2050000D+03, 0.2050000D+03, 0.2043700D+03, 0.1188200D+02, 0.3501000D+01, 0.6640100D+00, 0.1170000D+01, &
      0.2080000D+03, 0.2080000D+03, 0.2071900D+03, 0.1132200D+02, 0.3291000D+01, 0.8491200D+00, 0.1200000D+01, &
      0.2090000D+03, 0.2090000D+03, 0.2089800D+03, 0.9811300D+01, 0.2827000D+01, 0.8843300D+00, 0.1180000D+01, &
      0.2100000D+03, 0.2100000D+03, 0.2100000D+03, 0.9251100D+01, 0.2653000D+01, 0.8074600D+00, 0.1170000D+01, &
      0.2100000D+03, 0.2100000D+03, 0.2100000D+03, 0.0000000D+00, 0.0000000D+00, 0.4335700D+00, 0.1170000D+01, &
      0.2220000D+03, 0.2220000D+03, 0.2220000D+03, 0.0000000D+00, 0.0000000D+00, 0.4192300D+00, 0.1160000D+01, &
      0.2230000D+03, 0.2230000D+03, 0.2230000D+03, 0.0000000D+00, 0.0000000D+00, 0.4363800D+00, 0.1160000D+01, &
      0.2260000D+03, 0.2260000D+03, 0.2260000D+03, 0.5022200D+01, 0.1338000D+01, 0.5146400D+00, 0.1160000D+01, &
      0.2270000D+03, 0.2270000D+03, 0.2270000D+03, 0.0000000D+00, 0.0000000D+00, 0.7308700D+00, 0.1160000D+01, &
      0.2320000D+03, 0.2320000D+03, 0.2320000D+03, 0.1165800D+02, 0.3026000D+01, 0.8106500D+00, 0.1160000D+01, &
      0.2310000D+03, 0.2310000D+03, 0.2310000D+03, 0.1540000D+02, 0.4015000D+01, 0.1957800D+01, 0.1160000D+01, &
      0.2380000D+03, 0.2380400D+03, 0.2380400D+03, 0.1904300D+02, 0.4818000D+01, 0.1025700D+01, 0.1160000D+01/)

      contains
!******************************************************
      subroutine NSTOP(EE,M1,M2,Z1,Z2, SN)
!-----------------------------------------------------------
!---  CALCULATE THE UNIVERSAL NUCLEAR STOPPING POWERS
!---  EPSILON IS THE REDUCED ENERGY OF THE ION/TARGET COMBINATION
      IMPLICIT DOUBLE PRECISION(A-Z)
      EPSIL=32.53*M2*EE/(Z1*Z2*(M1+M2)*(Z1**0.23+Z2**0.23))
      IF(EPSIL.GE.30.0) GOTO 140
      A=(0.01321*EPSIL**0.21226)+(0.19593*EPSIL**0.5)
      SN=0.5*DLOG(1.0+1.1383*EPSIL)/(EPSIL+A)
      GOTO 150
  140 SN=DLOG(EPSIL)/(2.0*EPSIL)
!-----------------------------------------------------------
!---- NOW CONVERT FROM REDUCED UNIT TO EV-CM2/1E15
  150 SN=SN*Z1*Z2*M1*8.462/((M1+M2)*(Z1**0.23+Z2**0.23))

      !--- CONVERT UNIT TO KEV-CM2
      SN=SN*1.D-18
      return
      end subroutine NSTOP

!-------------------------------------------------------------------
!  The following part of programs are for the stopping power calculation
!  based on Zigler's formular (1985);
!
! ------ THE STOPPING OF ZIEGLER  of 1985
      subroutine ESTOP(EE,A1,A2,Z1,Z2,SE)
! ------------------------------------------------------
!    THE SUB. PROGRAM FROM ZIEGLAR ' THE STOPPING AND RANGE
!    OF IONS IN SOLIDS'
!
!     OUTPUT IS ELECTRONIC AND NUCLEAR STOPPING IN UNIT OF KEV-CM2
!     UNITS: 1 =KEV-CM2
!            2 =MEV-CM2/MG
!            3 =EV/ANGSTROM
!            4 =L.S.S REDUCED UNITS
!
!     Z1 = ION ATOMIC NUMBER
!     MM1= ION ATOMIC MASS
!     A1 = ION ATOMIC WEIGHT (AMU)
!     Z2 = TARGET ATOMIC NUMBER
!     A2 = TARGET ATOMIC WEIGHT (AMU)
!     EE = ION ENERGY (KEV)
!     UNITS = PHYSICAL UNITS OF STOPPING FOR OUTPUT
!     RHO = TARGET DENSITY (G/CM3)
!     ATRHO= TARGET DENSITY (ATOMS/CM3)
!     VFERMI = FERMI VELOCITY OF SOLID / V0
!     LFCTR = LAMBDA SRCEENING FACTOR FOR IONS
!     PCOEF = STOPPING COEFFICIENTS FOR PROTONS
!     SE = CALCULATED ELECTRONIC STOPPING (EV/ANGSTROM)
!     NEED DATA FILE : SCOEF DATA
!     SCOEF(*,1) = ATOMIC NUMBER OF ELEMENT
!     SCOEF(*,2) = ATOMIC MASS OF MOST ABUNDANT ISOTOPE
!     SCOEF(*,3) = ATOMIC WEIGHT OF M.A.I
!     SCOEF(*,4) = TARGET MASS(AMU)
!     SCOEF(*,5) = G/CM3 DENSITY (NORMAL ABUNDANCE)
!     SCOEF(*,6) = ATOMS/CM3*1E22 (NORMAL ABUNDANCE)
!     SCOEF(*,7) = FERMI VELOCITY OF SOLID /V0
!     SCOEF(*,8) = LAMBDA SCREENING FACTOR FOR IONS
!     SCOEF(92,*) TO SCOEF(184,*)= COEF.OF PROTON STOPPING
! ---------------------------------------------------------
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      INTEGER UNITS, IZ1, IZ2
      DATA UNITS/1/
! TEST IF INPUT PARAMETERS ARE WITHIN LIMIT OF PROGRAM
      !CALL Stoping_Dat_Z85
      SE=0.0
!      SN=0.0
      IZ1=Z1+0.000001
      IZ2=Z2+0.000001
      IF(IZ1.GT.92) GOTO 190
      IF(EE.LT.1.0E-10) GOTO 230
! TEST IF INPUT PARAMETERS ARE WITHIN LIMIT OF PROGRAM
      E=EE/A1
!      IF(E.GT.1.0E5) GOTO 190
! JUMP TO SPECIAL STOPPING CALCULATION DEPENDING ON ION TYPE
      IF(IZ1.EQ.1) THEN
        CALL PSTOPZ(Z1,A1,Z2,A2,E,SE)
      ELSE
        IF(IZ1.EQ.2) THEN
           CALL HESTOPZ(Z1,A1,Z2,A2,E,SE)
        ELSE
           CALL HISTOPZ(Z1,A1,Z2,A2,E,EE,SE)
        ENDIF
      ENDIF

!---- NOW CONVERT TO DESIRED STOPPING UNITS
      GOTO (230,160,170,180), UNITS
!---- CONVERT TO MEV-CM2/MG
  160 SE=SE*.60222/A2
      GOTO 230
!---- CONVERT TO EV/ANGSTROM
  170 SE=SE*m_TGCOEF((IZ2-1)*7+5)*1.0E-1
      GOTO 230
!---- CONVERT TO L.S.S.REDUCED UNITS
  180 A=((A1+A2)*(Z1**0.6667+Z2**0.6667)**0.5)/(Z1*Z2*A1*8.462)
      SE=SE*A
      GOTO 230
  190 continue

!--- CONVERT EV-CM2/1E15 TO KEV-CM2 (noted by HOU Qing)
  230 SE = SE*1.D-18
      RETURN
      end subroutine ESTOP

!*************************************************************
!----- PROTON ELECTRONIC STOPPING POWER
      SUBROUTINE PSTOPZ(Z1,A1,Z2,A2,E,SE)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      INTEGER IZ1, IZ2, IS
! ---- VELOCITY PROPOTIONAL STOPPING BELOW VELOCITY PE0
      IZ1=Z1+0.000001
      IZ2=Z2+0.000001
      IS =(IZ2-1)*8
  100 PE0=25.0
      PE=DMAX1(PE0,E)
      SL=(m_PCOEF(IS+1)*PE**m_PCOEF(IS+2))+m_PCOEF(IS+3)*PE**m_PCOEF(IS+4)
      SH=m_PCOEF(IS+5)/PE**m_PCOEF(IS+6)*DLOG((m_PCOEF(IS+7)/PE)+m_PCOEF(IS+8)*PE)
      SE=SL*SH/(SL+SH)
      IF(E.GT.PE0) GOTO 110
! ---- VELPWR IS THE POWER OF VELOCITY STOPPING BELOW PE0
      VELPWR=0.45
      IF(IZ2.LE.6.0) VELPWR=0.25
      SE=SE*(E/PE0)**VELPWR
  110 RETURN
      END SUBROUTINE PSTOPZ

!*************************************************************
!----- HELIUM ELECTRONIC STOPPING POWER
      SUBROUTINE HESTOPZ(Z1,A1,Z2,A2,E,SE)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER IZ1, IZ2

! ---- VELOCITY PROPOTIONAL STOPPING BELOW KEV/AMU HE0
      IZ1=Z1+0.000001
      IZ2=Z2+0.000001
      HE0=1.0
      HE=DMAX1(HE0,E)
  100 B=DLOG(HE)
! ---- BELOW IS FORMULA FOR THE RATION OF HE TO PROTON S.P.
      A=0.2865+0.1266*B-0.001429*B*B+0.02402*B**3-0.01135*B**4+0.001475*B**5
      AAA=DMIN1(30.0D0,A)
      HEH=1.0-DEXP(-AAA)
! ---- ADD Z1**3 EFFECT TO HE/H S.P. RATIO HEH
      AAA=DLOG(HE)
      AAA=DMAX1(0.0D0,AAA)
      AAA=7.6-AAA
      A=1.0+(0.007+0.00005*Z2)*DEXP(-AAA**2)
      HEH=HEH*A*A
      CALL PSTOPZ(Z1,A1,Z2,A2,HE,SP)
      SE=SP*HEH*Z1**2
      IF(E.GT.HE0) GOTO 110
! ---- CALC. HE VELOCITY PROPORTIONAL STOPPING
      SE=SE*DSQRT(E/HE0)
  110 RETURN
      END SUBROUTINE HESTOPZ

!*************************************************************
!----- HEVAY ELECTRONIC STOPPING POWER
      SUBROUTINE HISTOPZ(Z1,A1,Z2,A2,E,EE,SE)
      IMPLICIT DOUBLE PRECISION (A-Z)
      INTEGER IZ1,IZ2
! ---- USE VELOCITY STOPPING FOR (YRMIN=VR/Z1**0.67).LE.0.13
! ---- OR FOR VR.LE.1.0
      IZ1=Z1+0.000001
      IZ2=Z2+0.000001
      YRMIN=0.13
      VRMIN=1.00
      VFERMI=m_TGCOEF((IZ2-1)*7+6)
      LFCTR =m_TGCOEF((IZ1-1)*7+7)
!      PRINT * ' IN HISTOP ... ',VFERMI,LFCTR,Z1,Z2,A1,A2,E,EE
      V=DSQRT(E/25.0)/VFERMI
  100 IF(V.GE.1.0) GOTO 110
      VR=(3.0*VFERMI/4.0)*(1.0+(2.0*V**2/3.0)-V**4/15.0)
      GOTO 120
  110 VR=V*VFERMI*(1.0+1.0/(5.0*V**2))
! ---- SET YR =MAXIMUM OF (VR/Z1**0.67),(VRMIN/Z1**0.67) OR YRMIN
  120 YR=DMAX1(YRMIN,VR/Z1**0.6667)
      YR=DMAX1(YR,VRMIN/Z1**0.6667)
      A=-0.803*YR**0.3+1.3167*YR**0.6+0.38157*YR+0.008983*YR*YR
      Q=DMIN1(1.0D0,DMAX1(0.0D0,1.0-DEXP(-DMIN1(A,50.0D0))))
! ---- Q =IONIZATION LEVEL OF THE ION AT VELOCITY YR
! ---- NOW WE CONVERT IONIZATION LEVEL TO EFFECTIVE CHARGE
      AAA=0.12+0.025*Z1
      AAA=DMAX1(0.32D0,AAA)
      B=DMIN1(0.43D0,AAA)/Z1**0.3333
      L0=(0.8-Q*(DMIN1(1.2D0,0.6+Z1/30.0)))/Z1**0.3333
      IF(Q.LT.0.2) GOTO 160
      IF(Q.LT.(DMAX1(0.0D0,0.9-0.025*Z1))) GOTO 150
      IF(Q.LT.(DMAX1(0.0D0,1.0-0.025*DMIN1(16.0D0,1.0*Z1)))) GOTO 140
  130 L1=B*(1.0-Q)/(0.025*DMIN1(16.0D0,Z1))
      GOTO 170
  140 L1=B
      GOTO 170
  150 Q1=0.2
      L1=B*(Q-0.2)/DABS(DMAX1(0.0D0,0.9-0.025*Z1)-0.2000001)
      GOTO 170
  160 L1=0.0
  170 L=DMAX1(L1,L0*LFCTR)
      ZETA=1.0+(4.0*L*VFERMI/1.919)**2
      ZETA=DLOG(ZETA)
      ZETA=Q+(1.0/(2.0*VFERMI**2))*(1.0-Q)*ZETA
! --- ADD Z1**3 EFFECT AS SHOWN IN REF. 779
      A=-(7.6-DMAX1(0.0D0,DLOG(E)))**2
      ZETA=ZETA*(1.0+(1.0/Z1**2)*(0.18+0.0015*Z2)*DEXP(A))
      IF(YR.LE.DMAX1(YRMIN,VRMIN/Z1**0.6667)) GOTO 190
 180  CALL PSTOPZ(Z1,A1,Z2,A2,E,SP)
      SE=SP*(ZETA*Z1)**2
      GOTO 200
! ---- CALC. VELOCITY STOPPING FOR YR LESS THAN YRMIN
 190  VRMIN=DMAX1(VRMIN,YRMIN*Z1**0.6667)
      VMIN=0.5*(VRMIN+DSQRT(DMAX1(0.0D0,VRMIN**2-0.8*VFERMI**2)))
      EEE=25.0*VMIN**2
      CALL PSTOPZ(Z1,A1,Z2,A2,EEE,SP)
      POWER=0.5
      IF(Z2.EQ.6) POWER=0.375
      IF((Z2.EQ.14).OR.(Z2.EQ.32).AND.(Z1.LE.19)) POWER=0.375
      SE=(SP*(ZETA*Z1)**2)*(E/EEE)**POWER
  200 RETURN
      END SUBROUTINE HISTOPZ
!*************************************************************

end module STOP_Z85_MODULE
